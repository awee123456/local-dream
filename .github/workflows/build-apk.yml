      # ขั้นตอนนี้สำคัญมาก ต้องติดตั้ง Ninja และ Dos2unix ก่อนเริ่ม
      - name: Install Build Tools
        run: |
          sudo apt-get update
          sudo apt-get install -y cmake ninja-build build-essential python3-pip dos2unix
          pip3 install gdown

      # ส่วนที่ต้องแก้ไข Path ให้ถูกต้องตามเครื่องของ GitHub
      - name: Build Native Libraries (The AI Engine)
        run: |
          cd app/src/main/cpp/
          
          # 1. ค้นหาตำแหน่ง NDK ที่แท้จริงบนเซิร์ฟเวอร์
          export NDK_PATH=$ANDROID_SDK_ROOT/ndk/$(ls $ANDROID_SDK_ROOT/ndk | sort -V | tail -1)
          echo "Using NDK at: $NDK_PATH"
          
          # 2. แก้ไขไฟล์ build.sh ให้ใช้ Path ที่ถูกต้อง (แทนที่ /data/... เดิม)
          sed -i "s|/data/android-ndk-r28|$NDK_PATH|g" build.sh
          
          # 3. เตรียมไฟล์สคริปต์
          dos2unix build.sh
          chmod +x build.sh
          
          # 4. ตั้งค่าตัวแปรสภาพแวดล้อมและรันการ Build
          export ANDROID_NDK_ROOT=$NDK_PATH
          export QNN_SDK_ROOT=${{ env.QNN_SDK_ROOT }}
          
          # ระบุตำแหน่ง Ninja ให้ชัดเจนเพื่อแก้ Error ในรูป 1000229858
          cmake -G Ninja -B build . \
            -DCMAKE_MAKE_PROGRAM=$(which ninja) \
            -DCMAKE_TOOLCHAIN_FILE=$NDK_PATH/build/cmake/android.toolchain.cmake \
            -DANDROID_ABI=arm64-v8a \
            -DANDROID_PLATFORM=android-21 \
            -DQNN_SDK_ROOT=$QNN_SDK_ROOT
          
          cmake --build build
